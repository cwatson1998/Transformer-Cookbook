\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{mathtools}
\usepackage{mleftright}
\usepackage{natbib}
\bibliographystyle{plainnat}
\usepackage[gen]{eurosym}
\usepackage{url}

% tables and such
\usepackage{blkarray}
\usepackage{colortbl}
\usepackage{tabularx}
\usepackage[dvipsnames]{xcolor} %more colors for frame boxes

\usepackage[english]{babel}
% \usepackage{textcomp}

\addtokomafont{paragraph}{\rmfamily}

\usepackage[breakable,skins]{tcolorbox}
\tcbuselibrary{theorems}

\usepackage[hidelinks]{hyperref}
\usepackage[capitalize,nameinlink]{cleveref} % should go after \tcbuselibrary and \usepackage{hyperref} but before \newtcbtheorem

% tikz stuff
\usepackage{tikz}
\usetikzlibrary{decorations.markings}
\usetikzlibrary{arrows,positioning,shapes,decorations,automata,petri,backgrounds,arrows.meta}
\usetikzlibrary{calc}
\usetikzlibrary{fit}
\usepackage{pgfplots}
\usepackage{dirtytalk}  % use \say{} for quotes
\usepackage{booktabs}

% David's NN package
\usepackage{nn}

\usepackage{scalerel}
\usepackage{stmaryrd}
\usepackage{enumitem}
\usepackage{xspace}

% % Andy slightly prefers dashes instead of dots, if nobody else cares
% \renewcommand{\labelitemi}{--}

\clubpenalty=10000
\widowpenalty=10000
\displaywidowpenalty=10000

\newcommand{\blank}{\text{\textvisiblespace}}
\newcommand{\N}{\mathbb{N}}
\newcommand{\NTo}[1]{\mymacro{\left[ #1 \right]}}
\newcommand*{\bqed}{\hfill\ensuremath{\blacksquare}}

\tcbset{theorembox/.style={%
            skin=standard jigsaw,% Better drawing engine
            breakable,% Allow breaking box on two pages
            parbox=false,% Make text flow like normal text
            boxrule=0mm,% In general no border
            leftrule=1mm,% Only left border
            boxsep=2mm,% General padding around text
            arc=0mm,% No rounded border
            outer arc=0mm,% No rounded border
            left=0mm,% Additional padding left of text
            right=0mm,% Additional padding right of text
            top=0mm,% Additional padding above text
            bottom=0mm,% Additional padding below text
            oversize,% Box content should be as wide as normal text
            enlarge top initially by=1mm,% Add some margin before the box starts
            description delimiters parenthesis,
            separator sign none,
            fonttitle=\bfseries,
            description font=\mdseries,
            terminator sign=.,
            coltitle=black,
        }}

\colorlet{Light-CadetBlue}{CadetBlue!50!white}
\definecolor{AnejBlue}{RGB}{0,120,148}	% green/blue 

\newtcbtheorem[crefname={definition}{Definition},Crefname={Definition}{Definition}]{definition}{Definition}{theorembox,colframe=RoyalBlue,colback=RoyalBlue!3,colbacktitle=RoyalBlue!3}{definition}

\newtcbtheorem[]{prf}{Proof}{theorembox,colframe=CadetBlue,colback=CadetBlue!3,colbacktitle=CadetBlue!3}{prf}

\newtcbtheorem[crefname={claim}{Claim},Crefname={Claim}{Claim}]{clm}{Claim}{theorembox,colframe=CarnationPink,colback=CarnationPink!3,colbacktitle=CarnationPink!3}{clm}

\newtcbtheorem[crefname={theorem}{Theorem},Crefname={Theorem}{Theorem}]{theorem}{Theorem}{theorembox,colframe=DarkOrchid,colback=DarkOrchid!3,colbacktitle=DarkOrchid!3}{thm}

\newtcbtheorem[crefname={corollary}{Corollary},Crefname={Corollary}{Corollary}]{cor}{Corollary}{theorembox,colframe=Dandelion,colback=Dandelion!3,colbacktitle=Dandelion!3}{cor}

\newtcbtheorem[crefname={example}{Example},Crefname={Example}{Example}]{exmp}{Example}{theorembox,colframe=ForestGreen,colback=ForestGreen!3,colbacktitle=ForestGreen!3}{exmp}

\newtcbtheorem[crefname={assumption}{Assumption},Crefname={Assumption}{Assumption}]{assumption}{Assumption}{theorembox,colframe=LightOrange,colback=LightOrange!10,colbacktitle=LightOrange!10}{exmp}

\newtcbtheorem[]{rem}{Remark}{theorembox,colframe=Peach,colback=Peach!3,colbacktitle=Peach!3}{rem}

\colorlet{HeadColor}{SeaGreen}
\newtcbtheorem[crefname={head}{Head},Crefname={Head}{Head}]{headwrapper}{Head}{
    theorembox,
    colframe=HeadColor,
    colback=HeadColor!3,
    colbacktitle=HeadColor!3,
    separator sign=:\ , % Use a period and space instead of parentheses
    description delimiters={} % Remove parentheses around the description
}{headwrapper}
\newenvironment{head}[1]
    {\begin{headwrapper}{#1}{}
    \begin{itemize}}
    {\end{itemize} 
    \end{headwrapper}}

% Transformer component shortcuts
\newcommand{\tf}{\mymacro{\mathcal{T}}}
\newcommand{\ReLU}{\text{ReLU}}
\newcommand{\GELU}{\text{GELU}}
\newcommand{\erf}{\text{erf}}
\newcommand{\att}{\textnormal{att}}
\newcommand{\dhid}{{d_{\textnormal{hid}}}}
\newcommand{\dff}{{d_{\textnormal{ff}}}}
\newcommand{\qproj}{W^{\textnormal{Q}}}
\newcommand{\kproj}{W^{\textnormal{K}}}
\newcommand{\vproj}{W^{\textnormal{V}}}
\newcommand{\oproj}{W^{\textnormal{O}}}
\newcommand{\nHead}{\mymacro{H}}

% Transformer class shortcuts
\newcommand{\UHAT}{\textsf{UHAT}}
\newcommand{\AHAT}{\textsf{AHAT}}
\newcommand{\SMAT}{\textsf{SMAT}}

% Language names
\newcommand{\dyckk}[1]{\textsc{Dyck}\text{-}\ensuremath{#1}}
\newcommand{\dyckkd}[2]{\textsc{Dyck}\text{-}\ensuremath{#1}\text{-}\ensuremath{#2}}
\newcommand{\shuffledyckk}[2]{\textsc{ShuffleDyck}\text{-}\ensuremath{#1}}

% Math shortcuts
\def\R{\mathbb{R}}
\def\Rex{\overline{\R}}
\def\N{\mathbb{N}}
\def\Z{\mathbb{Z}}
\def\C{\mathbb{C}}
\def\Q{\mathbb{Q}}
\def\Ccal{\mathcal{C}}
\def\Rcal{\mathcal{R}}
\def\Fcal{\mathcal{F}}
\def\Lcal{\mathcal{L}}
\def\Mcal{\mathcal{M}}
\def\Ncal{\mathcal{N}}
\def\F{\mathbb{F}}
\newcommand{\elt}[1]{_{#1}}
\newcommand{\cif}[3]{\ensuremath{#1\;\mathbf{?}\; #2\; \textbf{:} \;#3}}
\DeclareMathOperator*{\softmax}{softmax}

% Groupings
\DeclarePairedDelimiter\parens{(}{)}
\DeclarePairedDelimiter\bracks{[}{]}
\DeclarePairedDelimiter\braces{\{}{\}}
\DeclarePairedDelimiter\angles{\langle}{\rangle}
\DeclarePairedDelimiter\abs{\lvert}{\rvert}
\DeclarePairedDelimiter\norm{\lVert}{\rVert}
\DeclarePairedDelimiter\ceil{\lceil}{\rceil}
\DeclarePairedDelimiter\floor{\lfloor}{\rfloor}

% Fonts in math mode
\newcommand\mbb[1]{\mathbb{#1}}
\newcommand\mbf[1]{\mathbf{#1}}
\newcommand\mcal[1]{\mathcal{#1}}
\newcommand\mrm[1]{\mathrm{#1}}
\newcommand\msf[1]{\mathsf{#1}}


\setlength {\marginparwidth }{2cm}
% TODO notes
% \usepackage[disable]{todonotes}
\usepackage{todonotes}
\makeatletter
\newcommand*\iftodonotes{\if@todonotes@disabled\expandafter\@secondoftwo\else\expandafter\@firstoftwo\fi}  %
\makeatother
\newcommand{\noindentaftertodo}{\iftodonotes{\noindent}{}}
\newcommand{\fixme}[2][]{\todo[color=yellow,size=\scriptsize,fancyline,caption={},#1]{#2}}
\newcommand{\note}[4][]{\todo[author=#2,color=#3,size=\scriptsize,fancyline,caption={},#1]{#4}}

\newcommand{\AY}[2][]{\note[#1]{\textbf{Andy}}{ForestGreen!20}{#2}}
\newcommand{\AS}[2][]{\note[#1]{\textbf{Anej}}{AnejBlue!40}{#2}}
\newcommand{\DA}[2][]{\note[#1]{\textbf{Dana}}{RedViolet!20}{#2}}
\newcommand{\DC}[2][]{\note[#1]{\textbf{David}}{Dandelion!20}{#2}}
\newcommand{\WM}[2][]{\note[#1]{\textbf{Will}}{RoyalPurple!20}{#2}}
\newcommand{\AX}[2][]{\note[#1]{\textbf{Anton}}{blue!20}{#2}}
\newcommand{\CW}[2][]{\note[#1]{\textbf{Chris}}{gray!20}{#2}}
\newcommand{\LS}[2][]{\note[#1]{\textbf{Lena}}{MidnightBlue!20}{#2}}

\newcommand{\response}[1]{\vspace{3pt}\hrule\vspace{3pt}\textbf{#1:}}    % insert \response{myname} within someone else's todonote

% colorful comments
% \newcommand{\DA}[1]{({\textcolor{RedViolet}{\textbf{DA: #1}}})}
% \newcommand{\LS}[1]{({\textcolor{MidnightBlue}{\textbf{LS: #1}}})}
% \newcommand{\AY}[1]{({\textcolor{ForestGreen}{\textbf{AY: #1}}})}
% \newcommand{\DC}[1]{({\textcolor{Dandelion}{\textbf{DC: #1}}})}
% \newcommand{\WM}[1]{({\textcolor{RoyalPurple}{\textbf{WM: #1}}})}
\newcommand{\uvp}[1]{({\textcolor{Cyan}{\textbf{YP: #1}}})}
\newcommand{\GF}[1]{({\textcolor{Salmon}{\textbf{GF: #1}}})}
\newcommand{\BD}[1]{({\textcolor{BlueGreen}{\textbf{BD: #1}}})}
\newcommand{\EF}[1]{({\textcolor{gray}{\textbf{EF: #1}}})}
% \newcommand{\AS}[1]{({\textcolor{AnejBlue}{\textbf{AS: #1}}})}
\newcommand{\CW}[1]{({\textcolor{PineGreen}{\textbf{CW: #1}}})}
\newcommand{\NS}[1]{({\textcolor{CarnationPink}{\textbf{NS: #1}}})}
\newcommand{\DF}[1]{({\textcolor{orange}{\textbf{DF: #1}}})}

\newcommand{\Instruction}[1]{{\textcolor{red}{\textbf{Instruction:} #1}}}
